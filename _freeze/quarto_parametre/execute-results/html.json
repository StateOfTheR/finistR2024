{
  "hash": "a704a334de831ed889933983c5908c2b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Documents paramétrés en quarto\"\nauthor: \"Pierre Gloaguen\"\nformat: html\n---\n\n\nCi dessous, vous trouverez un modèle de document paramétré en quarto.\n\n# Inclusion de paramètres personnalisés dans un document quarto\n\nIl est probable que l'exécution de l'exemple ainsi que son adaptation soit suffisant pour tout comprendre.\nCependant, après m'être un peu cassé les dents, quelques points importants.\n\n- La liste des paramètres doit être spécifiée dans l'en tête `yaml`.\n\n\n::: {.cell}\n\n```{.yaml .cell-code}\nparams:\n  correction: true # or false\n```\n:::\n\n\n- Afin d'interagir avec le code, il me semble qu'il est impératif d'utiliser `knitr` comme moteur de rendu, et non `jupyter`, **même quand l'on utilise pas de `R`** (notamment, quand tout est en `python`).\n\n\n::: {.cell}\n\n```{.yaml .cell-code}\nengine: knitr\n```\n:::\n\n\n- **Accès aux paramètres dans un code `R`** Pour accéder aux éléments de `params` dans un code `R`, il suffit d'y accéder comme dans n'importe quelle liste. Autrement dit, une liste `params` est créée au rendu, et on peut accéder à l'élément `correction` avec `params$correction` (voir l'exemple ci dessous).\n- **Accès aux paramètres dans un code `python`** Pour accéder aux éléments de `params` dans un code `R`, il faut accéder à l'objet `R` params dans python. Ceci est fait grâce au package `reticulate`.\nDans la pratique, au rendu, un **dictionnaire** python nommé `r.params` est créé. On peut accéder à l'élément `correction` avec `r.params[\"correction\"]` (voir l'exemple ci dessous).\n- **Accès aux paramètres dans les options d'un chunk** Pour faire appel au paramètre dans les options des chunks, il faut utiliser le préfixe `!expr` et appeler l'argument comme on le ferait en `R`. Ceci est vrai pour les chunks `R` et `python`.\nDans l'exemple ci dessous, on évalue un chunk conditionnellement à la correction en écrivant `#| eval:!expr \"params$correction\"`.\n- **Accès aux paramètres dans le texte pour des affichages conditionnels** Lorsque le paramètre est une condition qui doit gérer l'affichage (typiquement, affiche t'\"on la correction ou non ci dessous) il faut  utiliser les environnements `quarto` `.content-visible` dans lequel on utilisera l'option `when-meta=\"params.correction\"`.\n\n\n\n\n````{.markdown}\n---\ntitle: \"Exemple de document paramétré\"\nformat: pdf\nparams:\ncorrection: true\nengine: knitr # Obligatoire pour interagir avec le code, même si on ne fait que du python\n---\n  \n# Exemple dans du texte\n  \n:::{#exr-densite-loi-normale}\n## 1 point\n    \nSoit $X \\in \\mathbb{R}$ une variable aléatoire de loi $\\mathcal{N}(\\mu, \\sigma^2)$. \nDonner l'expression de $p(x)$, la densité de $X$.\n:::\n\n::: {.content-visible when-meta=\"params.correction\"}\n\n:::{#sol-densite-loi-normale}\nLa densité de $X$ est donnée par:\n$$\np(x)=\\frac{1}{\\sqrt{2\\pi \\sigma^2}}\\text{e}^{-\\frac{1}{2\\sigma^2}(x - \\mu)^2}\\,.\n$$\n:::\n\n:::\n\n# Exemple avec code conditionnel\n\n## Avec du `R`\n\n```{r}\n#| label: chunk-R-parametre\n#| eval: !expr \"params$correction\"\nifelse(params$correction,\n       \"Ce chunk est executé en mode correction\",\n       \"Ce chunk n'est pas executé en mode correction\")\n```\n\n## Avec du python\n\n```{python}\n#| label: exemple-python \n#| echo: fenced\n#| eval: !expr \"params$correction\"\nif r.params[\"correction\"]:\n  print(\"Ce texte s'affiche en mode correction\")\n```\n  \n````\n\n  \n# Compilation du document\n  \nPour compiler le document (dans `R`) avec la liste des paramètres voulus, on utilisera la fonction `quarto_render` du package `quarto`.\n  \n\n::: {.cell}\n\n```{.r .cell-code}\n# Pour compiler le document avec toutes les valeurs possibles du paramètres\npurrr::map(c(FALSE, TRUE), function(cor_){\n  # On rajoute les traitements dépendant de l'argument\n  output_name <- ifelse(cor_, \"sujet.pdf\", \"correction.pdf\") \n  quarto::quarto_render(input = \"mon_document.qmd\",  \n                        execute_params = list(correction  = cor_), \n                        output_format = \"pdf\",\n                        output_file = output_name)\n})\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}